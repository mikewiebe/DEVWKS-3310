---

# - name: Bring up vPC Peer-Link Ethernet Interfaces
#   cisco.dcnm.dcnm_interface:
#     check_deploy: True
#     fabric: "{{ ndfc_fabric_name }}" 
#     state: merged
#     config:
#       - name: Ethernet1/8
#         type: eth
#         switch:
#           - "{{ staging_leaf1 }}"
#           - "{{ staging_leaf2 }}"
#         deploy: true
#         profile:
#           admin_state: true
#           mode: trunk
#           speed: '10Gb'
#           bpdu_guard: true
#           port_type_fast: true
#           mtu: jumbo
#           allowed_vlans: none
#       - name: Ethernet1/9
#         type: eth
#         switch:
#           - "{{ staging_leaf1 }}"
#           - "{{ staging_leaf2 }}"
#         deploy: true
#         profile:
#           admin_state: true
#           mode: trunk
#           speed: '10Gb'
#           bpdu_guard: true
#           port_type_fast: true
#           mtu: jumbo
#           allowed_vlans: none

- name: Create vPC interface
  cisco.dcnm.dcnm_interface:
    check_deploy: False
    fabric: "{{ ndfc_fabric_name }}" 
    state: deleted                         # only choose form [merged, replaced, deleted, overridden, query]
    config:
      - name: vpc750                      # should be of the form vpc<port-id>
        type: vpc                         # choose from this list [pc, vpc, sub_int, lo, eth]
        switch:                           # provide switches of vPC pair
          - "{{ staging_leaf1 }}"
          - "{{ staging_leaf2 }}"
        deploy: true                      # choose from [true, false]
        profile:
          admin_state: true               # choose from [true, false]
          mode: trunk                     # choose from [trunk, access]
          peer1_pcid: 555                 # choose between [Min:1, Max:4096], if not given, will be VPC port-id
          peer2_pcid: 555                 # choose between [Min:1, Max:4096], if not given, will be VPC port-id
          peer1_members:                  # member interfaces on peer 1
            - "e1/15"
          peer2_members:                  # member interfaces on peer 2
            - "e1/15"
          pc_mode: 'active'               # choose from ['on', 'active', 'passive']
          bpdu_guard: true                # choose from [true, false, 'no']
          port_type_fast: true            # choose from [true, false]
          mtu: jumbo                      # choose from [default, jumbo]
          peer1_allowed_vlans: none       # choose from [none, all, vlan range] 
          peer2_allowed_vlans: none       # choose from [none, all, vlan range] 
          peer1_description: "VPC acting as trunk peer1"
          peer2_description: "VPC acting as trunk peer2"

# - name: Create loopback interfaces
#   cisco.dcnm.dcnm_interface:
#     fabric: "{{ ndfc_fabric_name }}"
#     state: deleted                         # only choose from [merged, replaced, deleted, overridden, query]
#     config:
#       - name: lo55                        # should be of the form lo<port-id>
#         type: lo                          # choose from this list [pc, vpc, sub_int, lo, eth]
#         switch:
#           - "{{ staging_leaf1 }}"   # provide the switch where to deploy the config
#         deploy: true                      # choose from [true, false]
#         profile:
#           admin_state: false               # choose from [true, false]
#           mode: lo                        # choose from [lo]
#           int_vrf: ""                     # VRF name
#           ipv4_addr: 192.169.10.1         # ipv4 address for the loopback interface
#           ipv6_addr: "fd01::201"          # ipV6 address for the loopback interface
#           route_tag: ""                   # Routing Tag for the interface
#           cmds:                           # Freeform config
#             - no shutdown
#           description: "loopback55 interface configuration"
  # vars:
  #     ansible_command_timeout: 200
  #     ansible_connect_timeout: 200
